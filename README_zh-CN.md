Languageï¼š[ä¸­æ–‡](README_zh-CN.md) | [English](README.md)
# C++ Excel è‡ªåŠ¨åŒ– MCP æœåŠ¡å™¨

è¿™æ˜¯ä¸€ä¸ªåŸºäº C++ çš„ Excel è‡ªåŠ¨åŒ– MCP (æ¨¡å‹ä¸Šä¸‹æ–‡åè®®) æœåŠ¡å™¨é¡¹ç›®ã€‚æœ¬é¡¹ç›®ä½¿ç”¨ OpenXLSX åº“è¿›è¡Œ Excel æ–‡ä»¶æ“ä½œï¼Œæ—¨åœ¨é€šè¿‡ MCP åè®®é…åˆ LLM èƒ½åŠ›æä¾›ä¸€å¥—æ™ºèƒ½åŒ–çš„ Excel æ“ä½œå·¥å…·ã€‚



## ç›®å½•

*   [é¡¹ç›®ç‰¹ç‚¹](#é¡¹ç›®ç‰¹ç‚¹)
*   [æ„å»ºé¡¹ç›®](#æ„å»ºé¡¹ç›®)
*   [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)


## é¡¹ç›®ç‰¹ç‚¹

*   **ç®€æ´æ˜“ç”¨çš„ MCP æ¥å£**: æä¾›æ ‡å‡†åŒ–çš„ MCP å·¥å…·ï¼Œæ–¹ä¾¿å®¢æˆ·ç«¯ï¼ˆå¦‚ AI åŠ©æ‰‹ï¼‰è°ƒç”¨ Excel è‡ªåŠ¨åŒ–åŠŸèƒ½ã€‚
*   **å•æ–‡ä»¶éƒ¨ç½²**: ç¼–è¯‘åç”Ÿæˆå•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œè¿è¡Œã€‚
*   **å¯å®šåˆ¶å¤šè¯­è¨€**: æ”¯æŒé€šè¿‡ JSON æ–‡ä»¶è½»æ¾æ·»åŠ æˆ–ä¿®æ”¹ç•Œé¢è¯­è¨€ã€‚

## æœåŠ¡å™¨èƒ½åŠ›

æœ¬ MCP æœåŠ¡å™¨æä¾›ä»¥ä¸‹å·¥å…·ï¼Œå¯é€šè¿‡ LLM è°ƒç”¨ä»è€Œå®ç°å’Œ xlsx è¡¨æ ¼æ–‡ä»¶çš„äº¤äº’ï¼š

*   **`open_excel_and_list_sheets`**:
    *   æè¿°: æ‰“å¼€ä¸€ä¸ª Excel æ–‡ä»¶å¹¶åˆ—å‡ºæ‰€æœ‰å·¥ä½œè¡¨åç§°ã€‚æ­¤å·¥å…·è¿˜å°†è®¾ç½®å½“å‰ Excel æ–‡ä»¶è·¯å¾„ä»¥ä¾›åç»­æ“ä½œä½¿ç”¨ã€‚å»ºè®®åœ¨è¿›è¡Œä»»ä½•æ“ä½œä¹‹å‰æˆ–æƒ³è¦æ›´æ”¹è¦ä¿®æ”¹çš„æ–‡ä»¶æ—¶é¦–å…ˆè¿è¡Œæ­¤å·¥å…·ã€‚
    *   å‚æ•°:
        *   `file_path` (string): Excel æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚
*   **`get_sheet_range_content`**:
    *   æè¿°: è·å–å¹¶è¾“å‡ºæŒ‡å®šå·¥ä½œè¡¨ä¸­æŒ‡å®šèŒƒå›´å†…çš„è¡¨æ ¼å†…å®¹ã€‚è‡ªåŠ¨æ‰“å¼€å’Œå…³é—­ Excel æ–‡ä»¶ã€‚
    *   å‚æ•°:
        *   `sheet_name` (string): è¦è¯»å–çš„å·¥ä½œè¡¨åç§°ã€‚
        *   `first_row` (number): èµ·å§‹è¡Œå·ï¼ˆä» 1 å¼€å§‹ï¼‰ã€‚
        *   `first_column` (number): èµ·å§‹åˆ—å·ï¼ˆä» 1 å¼€å§‹ï¼‰ã€‚
        *   `last_row` (number): ç»“æŸè¡Œå·ï¼ˆä» 1 å¼€å§‹ï¼‰ã€‚
        *   `last_column` (number): ç»“æŸåˆ—å·ï¼ˆä» 1 å¼€å§‹ï¼‰ã€‚
        *   `cell_with_coord` (boolean, å¯é€‰): è¾“å‡ºéç©ºå•å…ƒæ ¼åŠå…¶å„è‡ªçš„åæ ‡ï¼Œé€‚ç”¨äºè¾“å‡ºåŒºåŸŸåŒ…å«å¤§é‡ç©ºå•å…ƒæ ¼çš„æƒ…å†µã€‚
*   **`set_sheet_range_content`**:
    *   æè¿°: è®¾ç½®æŒ‡å®šå·¥ä½œè¡¨ä¸­æŒ‡å®šèŒƒå›´å†…çš„è¡¨æ ¼å†…å®¹ã€‚è‡ªåŠ¨æ‰“å¼€å’Œå…³é—­ Excel æ–‡ä»¶ã€‚
    *   å‚æ•°:
        *   `sheet_name` (string): è¦å†™å…¥çš„å·¥ä½œè¡¨åç§°ã€‚
        *   `first_row` (number): èµ·å§‹è¡Œå·ï¼ˆä» 1 å¼€å§‹ï¼‰ã€‚
        *   `first_column` (number): èµ·å§‹åˆ—å·ï¼ˆä» 1 å¼€å§‹ï¼‰ã€‚
        *   `values` (array[array]): è¦å†™å…¥èŒƒå›´çš„äºŒç»´æ•°ç»„å€¼ (æ”¯æŒ null, boolean, number, string ç±»å‹)ã€‚
*   **`create_xlsx_file_by_absolute_path`**: (æ³¨æ„ï¼šå·¥å…·åç§°åœ¨ä»£ç ä¸­å®šä¹‰ä¸ºæ­¤ï¼Œä½† JSON ä¸­é”®ä¸º `create_xlsx`)
    *   æè¿°: ä½¿ç”¨ç»™å®šè·¯å¾„åˆ›å»ºä¸€ä¸ªæ–°çš„ xlsx æ–‡ä»¶ã€‚åˆ›å»ºåè‡ªåŠ¨å…³é—­ Excel æ–‡ä»¶ã€‚
    *   å‚æ•°:
        *   `file_path` (string): æ–‡ä»¶åº”åˆ›å»ºåˆ°çš„ç»å¯¹è·¯å¾„ã€‚

*(æ³¨æ„ï¼šå·¥å…·æè¿°ä¸­æåˆ°çš„è‡ªåŠ¨æ‰“å¼€/å…³é—­è¡Œä¸ºæ˜¯å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒã€‚)*


## æ„å»ºé¡¹ç›®

æœ¬é¡¹ç›®ä½¿ç”¨ CMake æ„å»ºã€‚æ¨èå®‰è£… Ninja ä»¥è·å¾—æ›´å¿«çš„ç¼–è¯‘é€Ÿåº¦ã€‚

**æ„å»ºæ­¥éª¤:**

1.  **å‡†å¤‡ç¯å¢ƒ:**
    *   ç¡®ä¿å·²å®‰è£… C++17 ç¼–è¯‘å™¨ã€CMake (>= 3.15) å’Œ Ninjaã€‚
    *   å…‹éš†ä»“åº“: `git clone https://github.com/smileFAace/MCP-ExcelAutoCpp.git`
2.  **ç¼–è¯‘:**
    ```bash
    # è¿›å…¥é¡¹ç›®ç›®å½• (å¦‚æœä¸åœ¨é¡¹ç›®æ ¹ç›®å½•)
    # cd MCP-ExcelAutoCpp
    
    # ç”Ÿæˆæ„å»ºæ–‡ä»¶ (æ¨èä½¿ç”¨ Ninja)
    cmake -G "Ninja" -S . -B build
    
    # æ‰§è¡Œç¼–è¯‘
    cmake --build build
    ```
    ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶é€šå¸¸ä½äº `bin/` ç›®å½•ä¸‹ã€‚

## ä½¿ç”¨æ–¹æ³•

ç¼–è¯‘æˆåŠŸåï¼Œåœ¨ `./bin/` ç›®å½•ä¸‹æ‰¾åˆ°åä¸º `ExcelAutoCpp` (Linux/macOS) æˆ– `ExcelAutoCpp.exe` (Windows) çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**å¯åŠ¨æœåŠ¡å™¨**

ç›´æ¥è¿è¡Œè¯¥å¯æ‰§è¡Œæ–‡ä»¶å³å¯å¯åŠ¨ MCP æœåŠ¡å™¨ã€‚

```bash
# ç¤ºä¾‹ (è¯·æ ¹æ®å®é™…è·¯å¾„è°ƒæ•´)
./bin/ExcelAutoCpp
```

å½“çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºæ—¶ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å·²æˆåŠŸå¯åŠ¨å¹¶ç›‘å¬ `localhost:8888`ï¼š

```

â–‘â–ˆâ–€â–€â–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–€â–€â–‘â–ˆâ–€â–€â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–€â–ˆâ–€â–‘â–ˆâ–€â–ˆ
â–‘â–ˆâ–€â–€â–‘â–„â–€â–„â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–€â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–‘â–ˆâ–‘â–‘â–ˆâ–‘â–ˆ
â–‘â–€â–€â–€â–‘â–€â–‘â–€â–‘â–€â–€â–€â–‘â–€â–€â–€â–‘â–€â–€â–€â–‘â–€â–‘â–€â–‘â–€â–€â–€â–‘â–‘â–€â–‘â–‘â–€â–€â–€
v0.0.2                 By smileFAace

I(17:35:48) i18n: Successfully loaded language string for language code 'en'
I(17:35:48) i18n: Set current language to 'en'
W(17:35:48) lang.json not found at 'E:\prj\MCP-ExcelAutoCpp\bin\lang.json'. Using default language.
I(17:35:48) i18n: Set current language to 'en'
I(17:35:48) Current language set to: en
I(17:35:48) Starting MCP server at localhost:8888
I(17:35:48) Press Ctrl+C to stop the server
```

**è¿æ¥ä¸ä½¿ç”¨:**

æœ¬æœåŠ¡å™¨éµå¾ª MCP åè®®ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•å…¼å®¹ MCP çš„å®¢æˆ·ç«¯ï¼ˆå¦‚ Rooã€clineã€claudeã€cherry studio ç­‰ï¼‰è¿æ¥åˆ°æœåŠ¡å™¨çš„ SSE ç«¯ç‚¹ï¼ˆé»˜è®¤ä¸º `http://localhost:8888/sse`ï¼‰æ¥è°ƒç”¨å…¶æä¾›çš„ Excel è‡ªåŠ¨åŒ–å·¥å…·ã€‚

ä¾‹å¦‚ï¼Œåœ¨ cline ä¸­é…ç½®è¯¥ MCP æœåŠ¡å™¨ï¼Œåªéœ€åœ¨æœåŠ¡è¿è¡ŒæˆåŠŸåäºè¯¥æ’ä»¶æ‰€æä¾›çš„ mcp é…ç½® json æ–‡ä»¶ä¸­æ·»åŠ ä¸‹è¿°å†…å®¹å¹¶åˆ·æ–°ï¼š
```json
{
  "mcpServers": {
    "excel-auto-cpp": {
      "url": "http://localhost:8888/sse"
    }
  }
}
```

**æ›´æ”¹å’Œè‡ªå®šä¹‰æœåŠ¡å™¨è¯­è¨€:**

æœåŠ¡å™¨é»˜è®¤ä½¿ç”¨è‹±æ–‡ (`en`) ä½œä¸ºç•Œé¢è¯­è¨€ã€‚æ‚¨å¯ä»¥é€šè¿‡åˆ›å»ºè‡ªå®šä¹‰è¯­è¨€æ–‡ä»¶æ¥æ›´æ”¹è¯­è¨€ï¼š

1.  æ‰¾åˆ°æœåŠ¡å™¨å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼ˆé€šå¸¸æ˜¯ `bin/`ï¼‰ã€‚
2.  åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º `lang.json` çš„æ–‡æœ¬æ–‡ä»¶ã€‚
3.  å°†æ‚¨å¸Œæœ›ä½¿ç”¨çš„è¯­è¨€çš„**å®Œæ•´ç¿»è¯‘é”®å€¼å¯¹**å¤åˆ¶åˆ°è¿™ä¸ª `lang.json` æ–‡ä»¶ä¸­ã€‚
    *   æ‚¨å¯ä»¥å‚è€ƒé¡¹ç›®æºç ä¸­ `lang/` ç›®å½•ä¸‹çš„ `*.json` æ–‡ä»¶ä½œä¸ºæ¨¡æ¿ï¼ˆä¾‹å¦‚ï¼Œ[`lang/zh-cn/lang.json`](lang/zh-cn/lang.json) åŒ…å«ä¸­æ–‡ç¿»è¯‘ï¼‰ã€‚
    *   `lang.json` æ–‡ä»¶éœ€è¦åŒ…å«æ‰€æœ‰ç¨‹åºç•Œé¢å’Œæ—¥å¿—æ‰€éœ€çš„ç¿»è¯‘æ¡ç›®ã€‚

4.  ä¿å­˜ `lang.json` æ–‡ä»¶å¹¶é‡æ–°å¯åŠ¨æœåŠ¡å™¨ã€‚
    *   æœåŠ¡å™¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶åŠ è½½è¯¥æ–‡ä»¶ã€‚å¦‚æœåŠ è½½æˆåŠŸï¼Œå°†ä½¿ç”¨ `lang.json` ä¸­å®šä¹‰çš„è¯­è¨€ã€‚
    *   å¦‚æœ `lang.json` æ–‡ä»¶ä¸å­˜åœ¨ã€æ ¼å¼é”™è¯¯æˆ–ç¼ºå°‘å¿…è¦çš„ç¿»è¯‘æ¡ç›®ï¼ŒæœåŠ¡å™¨å°†å›é€€åˆ°é»˜è®¤çš„è‹±æ–‡ (`en`) è¯­è¨€ã€‚
    ```bash

    â–‘â–ˆâ–€â–€â–‘â–ˆâ–‘â–ˆâ–‘â–ˆâ–€â–€â–‘â–ˆâ–€â–€â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–€â–ˆâ–€â–‘â–ˆâ–€â–ˆ
    â–‘â–ˆâ–€â–€â–‘â–„â–€â–„â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–€â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–‘â–ˆâ–‘â–‘â–ˆâ–‘â–‘â–ˆâ–‘â–ˆ
    â–‘â–€â–€â–€â–‘â–€â–‘â–€â–‘â–€â–€â–€â–‘â–€â–€â–€â–‘â–€â–€â–€â–‘â–€â–‘â–€â–‘â–€â–€â–€â–‘â–‘â–€â–‘â–‘â–€â–€â–€
    v0.0.2                 By smileFAace

    I(20:27:30) i18n: Successfully loaded language string for language code 'en'
    I(20:27:30) i18n: Set current language to 'en'
    I(20:27:30) i18n: Successfully loaded language file 'F:\Prj\MCP-ExcelAutoCpp\bin\lang.json' for language code 'custom'
    I(20:27:30) i18n: Set current language to 'custom'
    I(20:27:30) Current language set to: custom
    I(20:27:30) åœ¨ localhost:8888å¯åŠ¨ MCP æœåŠ¡å™¨
    I(20:27:30) æŒ‰ Ctrl+C åœæ­¢æœåŠ¡å™¨
    ```


## ä¸‹è½½

æ‚¨å¯ä»¥ä» [å‘å¸ƒé¡µé¢](https://github.com/smileFAace/MCP-ExcelAutoCpp/releases) ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ã€‚

## ğŸŒŸæ˜Ÿæ˜Ÿå¢é•¿å²

[![Star History Chart](https://api.star-history.com/svg?repos=smileFAace/MCP-ExcelAutoCpp&type=Timeline)](https://www.star-history.com/#smileFAace/MCP-ExcelAutoCpp&Timeline)


